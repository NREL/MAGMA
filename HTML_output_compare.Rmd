---
title: "Multi-area Grid Metrics Analyzer Comparison Plots"
author: "Created by: `r Sys.info()['user']`"
date: "`r format(Sys.time(), '%d %B %Y')`"
output: 
  html_document: 
    css: custom.css
    toc: yes
---

```{r setOptions, echo=FALSE, warning=FALSE, message=FALSE, error=FALSE}
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

# files = list.files(pattern = 'RData', path = db.loc)
# n.files = length(files)
# yr.files = c('yr.data.generator', 'yr.data.interface.flow', 'yr.data.region', 'yr.data.zone', 'yr.data.reserve')
# int.files = c('int.data.avail.cap', 'int.data.gen', 'int.data.interface', 'int.data.region', 'int.data.reserve')

# for ( i in 1:length(files) ) {
#   load(paste0(db.loc, '/', files[i]))
  
#   for ( j in 1:length(yr.files) ) {
#     assign(paste0('SC', i, '.', yr.files[j]), get(yr.files[j]))
#   }
  
#   for ( j in 1:length(int.files) ) {
#     assign(paste0('SC', i, '.', int.files[j]), get(int.files[j]))
#   }

#   r.load = tryCatch( region_load(), error = function(cond) { return('ERROR') } )
#   z.load = tryCatch( zone_load(), error = function(cond) { return('ERROR') } )
#   region.names = region_stats()$name
#   zone.names = zone_stats()$name

#   assign(paste0('SC', i, '.r.load'), r.load)
#   assign(paste0('SC', i, '.z.load'), z.load)
#   assign(paste0('SC', i, '.region.names'), region.names)
#   assign(paste0('SC', i, '.zone.names'), zone.names)

# }

# Set up default options for chunks, turn off error or warning messages.
knitr::opts_chunk$set(echo=FALSE, comment=NA, warning=FALSE, message=FALSE, include=FALSE,
                      fig.path=fig.path.name, dev='png')
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
```

### Data below generated for:
"`r gsub('.*Model', 'Model', db$filename)`"

***
## Annual Dispatch Stacks 
***
## 1. Generation Differences
```{r gen-diff-stack}
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
source('source_scripts/compare/c_p_diff_gen_stack.R')
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
```

***
## 2. Zonal Generation
```{r zone-gen-diff-stacks}
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  source('source_scripts/compare/c_p_zone_gen_stacks.Rmd')
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
```

***
## 3. Regional Generation
```{r region-gen-diff-stacks}
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
source('source_scripts/compare/c_p_region_gen_stacks.R')
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
```

***
## 4. Individual Regions
```{r individual-region-diff-stacks}
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
print("not done yet")
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
```

***
## 5-7. Specified Period Dispatch Stacks
#``` {r key-period-dispatch, cache=FALSE}
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
#```

### Total

***
### Zones

***
### Regions

***
## 8-9. Curtailment
***
### 8. Average Daily Curtailment
```{r yearly-curtailment-diff}
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
source('source_scripts/compare/c_t_diff_curtailment.R')
if(exists('curt.diff')) { kable(curt.diff, format.args = list(big.mark = ','), digits=2) }
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
```

***
### 9. Average Interval Curtailment
```{r daily-curtailment-diff}
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
print("maybe make plot of differences in when curtailment happens")
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
```

***
## 10. Total Cost Differences
```{r annual-cost-difference-table}
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
source("source_scripts/compare/c_t_diff_annual_cost.R")
if(exists('cost.diff.table')) { kable(cost.diff.table, format.args = list(big.mark = ',')) }
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
```

***
## 12. Region and Zone Info (GWh)
``` {r region-zone-flow-diff-tables}
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
```

***
## 13. Interface Flow Table
```{r interface-flow-diff-table}
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
```

***
## 14. Interface Flow Plots
```{r interface-flow-diff-plots}
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
```

***
## 16-17. Reserves
***
### 16. Annual Reserve Shortage by Scenario
```{r annual-reserves-scen-table}
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
source('source_scripts/compare/c_t_total_reserve_shortage.R')
if(exists('res.short.table')) { kable(res.short.table, format.args = list(big.mark = ',')) }
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
```

***
### 17. Reserve Provisions by generator type
```{r reserves-stacks}
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
source("source_scripts/compare/c_p_reserves_stack.R")
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
```

***
## 20. Region Price Duration Curves
```{r price-duration-curve-scen}
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
source('source_scripts/compare/c_p_price_duration_curve.R')
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
```





