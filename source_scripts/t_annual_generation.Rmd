
```{r annual_generation_table, include=TRUE}

if ( exists('yr.gen') ) {

if ( typeof(yr.gen)=='character' ) { 
print('ERROR: gen_by_type function in "total-gen-stack" chunk not returning correct results.')
} else {
    
  gen.tot = data.frame('Type'='Total', 'GWh'=sum(yr.gen$GWh) - yr.gen$GWh[yr.gen$Type=='Curtailment'])
  yr.gen = rbind(yr.gen, gen.tot)
  percent = data.frame('Percent'= yr.gen$GWh / yr.gen$GWh[yr.gen$Type=='Total'] * 100)
  yr.gen = cbind(yr.gen, percent)
  kable(yr.gen, format.args = list(big.mark = ','), digits=2)

}
} else { print('Yearly generation data not found. Make sure "total-gen-stack" chunk is running.')  }
```
